<p id="notice"><%= notice %></p>

<h1>Tours</h1>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Price</th>
      <th>Booking deadline</th>
      <th>Start date</th>
      <th>End date</th>
      <th>Start location</th>
      <th>Total seats</th>
      <th>Status</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @tours.each do |tour| %>
      <tr>
        <td><%= tour.name %></td>
        <td><%= tour.price %></td>
        <td><%= tour.deadline %></td>
        <td><%= tour.start_date %></td>
        <td><%= tour.end_date %></td>
        <td><%= tour.start_location %></td>
        <td><%= tour.total_seats %></td>
        <td><%= tour.show_status %></td>
        <td><%= link_to 'Show', tour %></td>
        <% if (current_user.agent? && current_user.id == tour.user_id) || current_user.admin? %>
          <td><%= link_to 'Edit', edit_tour_path(tour) %></td>
          <% if !tour.isCompleted? %>
            <td><%= link_to 'Cancel', cancel_tour_tour_path(tour), method: :put, data: { confirm: 'Are you sure to cancel Tour?' } %></td>
          <% end %>
          <td><%= link_to 'Delete', tour, method: :delete, data: { confirm: 'Are you sure to Delete Tour?' } %></td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<% if current_user.agent? || current_user.admin? %>
  <%= link_to 'Create New Tour', new_tour_path %> |
<% end %>
<br/>
<td><%= link_to 'Back to User page', users_url %></td>
